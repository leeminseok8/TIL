## 💡 Better Way4: C스타일 형식 문자열을 str.format과 쓰기보다는 f-문자열을 통한 인터폴레이션을 사용하라

**형식화**는 미리 정의된 문자열에 데이터 값을 끼워 넣어서 사람이 보기 좋은 문자열로 저장하는 과정이다. 파이썬에서는 언어에 내장된 기능과 표준 라이브러리를 통해 네 가지 방식으로 형시고하를 할 수 있다. 하지만 한 가지 방법을 제외한 나머지는 모두 심각한 단점이 존재한다. 각각의 단점을 이해하고 피하도록 하자.

파이썬에서 문자열을 형식화하는 가장 일반적인 방법은 % 형식화 연산자를 사용하는 것이다. 이 연산자 왼쪽에 들어가는 미리 정의된 텍스트 템플릿을 **형식 문자열**이라고 부른다. 형식 문자열은 연산자 왼쪽에 있는 값을 끼워 넣을 자리를 표현하기 위해 %d 같은 형식 지정자를 사용한다. 형식 지정자의 문법은 C의 printf 함수에서 비롯됐으며, 파이썬에 이식됐다.

하지만 파이썬에서 C 스타일 형식 문자열을 사용하는 데는 네 가지 문제점이 있다.

- 첫 번째 문제점은 형시고하 식에서 오른쪽에 있는 tuple 내 데이터 값의 순서를 바꾸거나 값의 타입을 바꾸면 타입 변환이 불가능하므로 오류가 발생할 수 있다는 점이다.(대입할 변수의 순서, 타입 변경 불가능)
    - %연산자의 좌우가 서로 잘 맞는지 계속 검사해야 한다. 사람이 직접 검사해야 하므로 검사 과정에서 실수하기 쉽다.

<br>

- 두 번째 문제점은 형식화를 하기 전에 값을 변경해야 한다면(이런 경우가 꽤 많이 있다) 식을 일긱가 매우 어려워진다는 점이다.
    - 형식화 식에 있는 tuple의 길이가 너무 길어져서 여러 줄에 나눠 써야 하는데, 그로 인해 가독성이 나빠진다.

<br>

- 세 번째 문제점은 형식화 문자열에서 같은 값을 여러 번 사용하고 싶다면 튜플에서 같은 값을 여러 번 반복해야 한다는 점이다.
    - 같은 값을 반복해야 하면, 형식화할 값을 살짝 변경해야 하는 경우 실수하기도 쉽고 코딩하기에도 성가시다.

<br>

- 네 번째 문제점은 형식화 식에 딕셔너리를 사용하면 문장이 번잡스러워진다는 점이다.
    - 각 키를 최소 두 번(한 번은 형식 지정자에, 다른 한 번은 딕셔너리 키에) 반복하게 된다. 키에 해당하는 값이 변수에 들어 있다면 변수 이름까지 세 번 이상 같은 이름을 반복해서 사용하게 될 수도 있다.

---

<br>

### 내장함수 format과 str.format
파이썬 3부터는 C 스타일 형식화 문자열보다 더 표현력이 좋은 고급 문자열 형식화 기능이 도입됐다. 이 기능은 format 내장 함수를 통해 모든 파이썬 값에 사용할 수 있다.(천 단위 구분자를 표시할 때 쓰는 ',' 와 중앙에 값을 표시하는 '^')

<br>

#### 장점
format 내장 함수는 위치 지정자 중활호에 위치 인덱스를 전달할 수 있다. 이렇게 하면 인자의 순서를 바꾸지 않아도 형식화한 값의 출력 순서를 변경할 수 있으므로, 첫 번째 문제점을 해결할 수 있다.

형식화 문자열 안에서 같은 위치 인덱스를 여러 번 사용할 수도 있다. 이렇게 하면 인자에 값을 여러 번 반복할 필요가 없으므로, 세 번째 문제점도 해결된다.

<br>

#### 단점
하지만 형식화를 하기 전에 값을 조금 변경해야 하는 경우에는 코드가 읽기 어려워진다(두 번째 문제).

또한 위치 지정자의 표현력 부족으로 인해 생기는 제약이 너무 커서 str의 format 메서드의 가치를 떨어뜨린다.(네 번째 문제)

형식 지정자에 사용하는 새로운 미니 언어와 format 내장 함수를 사용하는 방법은 알아야 하지만, str.format의 나머지 부분은 f-문자열의 동작과 유용성을 이해햐는데 도움을 주는 정도로 간주해야 한다.

---

<br>

## 인터폴레이션을 통한 형식 문자열
이 문제를 해결하기 위해 파이썬 3.6부터 **인터폴레이션을 통한 형식 문자열(f-문자열)** 이 도입됐다. 앞에서 살펴본 format 함수의 내장 미니 언어를 f-문자열에도 사용할 수 있다.

f-문자열을 사용한 형식화는 C 스타일 형식화, str.format 메서드를 사용하는 경우보다 항상 짧다. 다음 예제를 통해 비교할 수 있다.
```
f_string = f'{key:<10>} = {value:.2f}'

c_tuple = '%-10s = %.2f' % (key, value)

str_args = '{:<10} = {.2f}'.format(key, value)

str_kw = '{key:<10} = {value:.2f}'.format(key=key, value=value)

c_dict = '%(key)-10s = %(value).2f' % {'key'=key, 'value'=value}
```

f-문자열을 사용하면 위치 지정자 중괄호 안에 완전한 파이썬 식을 넣을 수 있다. f-문자열이 제공하는 표현력, 간결성, 명확성을 고려할 때 파이썬 프로그래머가 사용할 수 있는 형식화 옵션 중에서 f-문자열이 최고이며, 가장 파이썬스러운 기능인 것 같다.